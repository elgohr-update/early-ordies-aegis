{"ast":null,"code":"var bip39 = require('bip39');\nvar hdkey = require('ethereumjs-wallet/hdkey');\nvar keythereum = require('keythereum');\nexports.debug = false;\nfunction getPrivateKeyFromMnemonic(mnemonic) {\n  var hdwallet = hdkey.fromMasterSeed(bip39.mnemonicToSeed(mnemonic));\n  var wallet_hdpath = \"m/44'/60'/0'/0/\";\n  var wallet = hdwallet.derivePath(wallet_hdpath + '0').getWallet();\n  var privateKey = wallet._privKey.toString('hex');\n  var account = '0x' + wallet.getAddress().toString('hex').toUpperCase();\n  if (exports.debug) console.log({\n    mnemonic: mnemonic,\n    privateKey: privateKey,\n    account: account\n  });\n  return privateKey;\n}\nexports.getPrivateKeyFromMnemonic = getPrivateKeyFromMnemonic;\nfunction getPrivateKeyFromRandom() {\n  var params = {\n    keyBytes: 32,\n    ivBytes: 16\n  };\n  var dk = keythereum.create(params);\n  var privateKey = dk.privateKey.toString('hex');\n  if (exports.debug) console.log({\n    privateKey: privateKey,\n    salt: dk.salt.toString('hex'),\n    iv: dk.iv.toString('hex')\n  });\n  return privateKey;\n}\nexports.getPrivateKeyFromRandom = getPrivateKeyFromRandom;\nfunction getPrivateKeyFromKeystore(keystore, password) {\n  var privateKeyBuf = keythereum.recover(password, keystore);\n  var privateKey = privateKeyBuf.toString('hex');\n  if (exports.debug) console.log({\n    privateKey: privateKey,\n    password: password,\n    keystore: keystore\n  });\n  return privateKey;\n}\nexports.getPrivateKeyFromKeystore = getPrivateKeyFromKeystore;\nfunction getKeystoreFromPrivateKey(privateKey, password) {\n  var params = {\n    keyBytes: 32,\n    ivBytes: 16\n  };\n  var dk = keythereum.create(params);\n  var options = {\n    kdf: 'pbkdf2',\n    cipher: 'aes-128-ctr',\n    kdfparams: {\n      c: 262144,\n      dklen: 32,\n      prf: 'hmac-sha256'\n    }\n  };\n\n  // const keystore = keythereum.dump(password, dk.privateKey, dk.salt, dk.iv, options);\n  var keystore = keythereum.dump(password, privateKey, dk.salt, dk.iv, options);\n  if (exports.debug) {\n    console.log({\n      privateKey: privateKey,\n      password: password,\n      keystore: keystore\n    });\n  }\n  return keystore;\n}\nexports.getKeystoreFromPrivateKey = getKeystoreFromPrivateKey;","map":null,"metadata":{},"sourceType":"script"}