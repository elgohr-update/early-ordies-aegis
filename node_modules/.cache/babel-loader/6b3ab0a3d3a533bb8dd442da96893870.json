{"ast":null,"code":"import _asyncToGenerator from \"/home/cryptodev/Dev/aegis-burner/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/cryptodev/Dev/aegis-burner/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"/home/cryptodev/Dev/aegis-burner/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/home/cryptodev/Dev/aegis-burner/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/home/cryptodev/Dev/aegis-burner/src/contexts/Withdrawal.js\";\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return exports; }; var exports = {}, Op = Object.prototype, hasOwn = Op.hasOwnProperty, defineProperty = Object.defineProperty || function (obj, key, desc) { obj[key] = desc.value; }, $Symbol = \"function\" == typeof Symbol ? Symbol : {}, iteratorSymbol = $Symbol.iterator || \"@@iterator\", asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\", toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\"; function define(obj, key, value) { return Object.defineProperty(obj, key, { value: value, enumerable: !0, configurable: !0, writable: !0 }), obj[key]; } try { define({}, \"\"); } catch (err) { define = function define(obj, key, value) { return obj[key] = value; }; } function wrap(innerFn, outerFn, self, tryLocsList) { var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator, generator = Object.create(protoGenerator.prototype), context = new Context(tryLocsList || []); return defineProperty(generator, \"_invoke\", { value: makeInvokeMethod(innerFn, self, context) }), generator; } function tryCatch(fn, obj, arg) { try { return { type: \"normal\", arg: fn.call(obj, arg) }; } catch (err) { return { type: \"throw\", arg: err }; } } exports.wrap = wrap; var ContinueSentinel = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var IteratorPrototype = {}; define(IteratorPrototype, iteratorSymbol, function () { return this; }); var getProto = Object.getPrototypeOf, NativeIteratorPrototype = getProto && getProto(getProto(values([]))); NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype); var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype); function defineIteratorMethods(prototype) { [\"next\", \"throw\", \"return\"].forEach(function (method) { define(prototype, method, function (arg) { return this._invoke(method, arg); }); }); } function AsyncIterator(generator, PromiseImpl) { function invoke(method, arg, resolve, reject) { var record = tryCatch(generator[method], generator, arg); if (\"throw\" !== record.type) { var result = record.arg, value = result.value; return value && \"object\" == typeof value && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) { invoke(\"next\", value, resolve, reject); }, function (err) { invoke(\"throw\", err, resolve, reject); }) : PromiseImpl.resolve(value).then(function (unwrapped) { result.value = unwrapped, resolve(result); }, function (error) { return invoke(\"throw\", error, resolve, reject); }); } reject(record.arg); } var previousPromise; defineProperty(this, \"_invoke\", { value: function value(method, arg) { function callInvokeWithMethodAndArg() { return new PromiseImpl(function (resolve, reject) { invoke(method, arg, resolve, reject); }); } return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(innerFn, self, context) { var state = \"suspendedStart\"; return function (method, arg) { if (\"executing\" === state) throw new Error(\"Generator is already running\"); if (\"completed\" === state) { if (\"throw\" === method) throw arg; return doneResult(); } for (context.method = method, context.arg = arg;;) { var delegate = context.delegate; if (delegate) { var delegateResult = maybeInvokeDelegate(delegate, context); if (delegateResult) { if (delegateResult === ContinueSentinel) continue; return delegateResult; } } if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) { if (\"suspendedStart\" === state) throw state = \"completed\", context.arg; context.dispatchException(context.arg); } else \"return\" === context.method && context.abrupt(\"return\", context.arg); state = \"executing\"; var record = tryCatch(innerFn, self, context); if (\"normal\" === record.type) { if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue; return { value: record.arg, done: context.done }; } \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg); } }; } function maybeInvokeDelegate(delegate, context) { var methodName = context.method, method = delegate.iterator[methodName]; if (undefined === method) return context.delegate = null, \"throw\" === methodName && delegate.iterator.return && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method) || \"return\" !== methodName && (context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a '\" + methodName + \"' method\")), ContinueSentinel; var record = tryCatch(method, delegate.iterator, context.arg); if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel; var info = record.arg; return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel); } function pushTryEntry(locs) { var entry = { tryLoc: locs[0] }; 1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry); } function resetTryEntry(entry) { var record = entry.completion || {}; record.type = \"normal\", delete record.arg, entry.completion = record; } function Context(tryLocsList) { this.tryEntries = [{ tryLoc: \"root\" }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0); } function values(iterable) { if (iterable) { var iteratorMethod = iterable[iteratorSymbol]; if (iteratorMethod) return iteratorMethod.call(iterable); if (\"function\" == typeof iterable.next) return iterable; if (!isNaN(iterable.length)) { var i = -1, next = function next() { for (; ++i < iterable.length;) { if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next; } return next.value = undefined, next.done = !0, next; }; return next.next = next; } } return { next: doneResult }; } function doneResult() { return { value: undefined, done: !0 }; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), defineProperty(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) { var ctor = \"function\" == typeof genFun && genFun.constructor; return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name)); }, exports.mark = function (genFun) { return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun; }, exports.awrap = function (arg) { return { __await: arg }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () { return this; }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) { void 0 === PromiseImpl && (PromiseImpl = Promise); var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl); return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) { return result.done ? result.value : iter.next(); }); }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () { return this; }), define(Gp, \"toString\", function () { return \"[object Generator]\"; }), exports.keys = function (val) { var object = Object(val), keys = []; for (var key in object) { keys.push(key); } return keys.reverse(), function next() { for (; keys.length;) { var key = keys.pop(); if (key in object) return next.value = key, next.done = !1, next; } return next.done = !0, next; }; }, exports.values = values, Context.prototype = { constructor: Context, reset: function reset(skipTempReset) { if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) { \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined); } }, stop: function stop() { this.done = !0; var rootRecord = this.tryEntries[0].completion; if (\"throw\" === rootRecord.type) throw rootRecord.arg; return this.rval; }, dispatchException: function dispatchException(exception) { if (this.done) throw exception; var context = this; function handle(loc, caught) { return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught; } for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i], record = entry.completion; if (\"root\" === entry.tryLoc) return handle(\"end\"); if (entry.tryLoc <= this.prev) { var hasCatch = hasOwn.call(entry, \"catchLoc\"), hasFinally = hasOwn.call(entry, \"finallyLoc\"); if (hasCatch && hasFinally) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } else if (hasCatch) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); } else { if (!hasFinally) throw new Error(\"try statement without catch or finally\"); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } } } }, abrupt: function abrupt(type, arg) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) { var finallyEntry = entry; break; } } finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null); var record = finallyEntry ? finallyEntry.completion : {}; return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record); }, complete: function complete(record, afterLoc) { if (\"throw\" === record.type) throw record.arg; return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel; }, finish: function finish(finallyLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel; } }, catch: function _catch(tryLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc === tryLoc) { var record = entry.completion; if (\"throw\" === record.type) { var thrown = record.arg; resetTryEntry(entry); } return thrown; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(iterable, resultName, nextLoc) { return this.delegate = { iterator: values(iterable), resultName: resultName, nextLoc: nextLoc }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel; } }, exports; }\nimport React, { createContext, useContext, useReducer, useMemo, useCallback, useEffect } from 'react';\nimport { safeAccess } from '../utils';\nimport { isAddress } from 'web3-utils';\nimport { useNocustClient, useEraNumber } from './Nocust';\nimport { useTokens } from './Tokens';\nimport { createNocustManager } from '../services/nocustManager';\nimport { nocust } from 'nocust-client';\nimport Web3 from 'web3';\nvar UPDATE_LIMIT = 'UPDATE_LIMIT';\nvar UPDATE_FEE = 'UPDATE_FEE';\nvar UPDATE_BLOCKS = 'UPDATE_BlOCKS';\nvar WithdrawalContext = createContext();\nfunction useWithdrawalContext() {\n  return useContext(WithdrawalContext);\n}\nfunction reducer(state, _ref) {\n  var type = _ref.type,\n    payload = _ref.payload;\n  switch (type) {\n    case UPDATE_FEE:\n      {\n        var withdrawalFee = payload.withdrawalFee;\n        return _objectSpread({}, state, {\n          withdrawalFee: withdrawalFee\n        });\n      }\n    case UPDATE_LIMIT:\n      {\n        var address = payload.address,\n          tokenAddress = payload.tokenAddress,\n          withdrawalLimit = payload.withdrawalLimit;\n        return _objectSpread({}, state, _defineProperty({}, address, _objectSpread({}, safeAccess(state, [address]) || {}, _defineProperty({}, tokenAddress, _objectSpread({}, safeAccess(state, [address, tokenAddress]) || {}, {\n          withdrawalLimit: withdrawalLimit\n        })))));\n      }\n    case UPDATE_BLOCKS:\n      {\n        var _address = payload.address,\n          _tokenAddress = payload.tokenAddress,\n          blocksToWithdrawal = payload.blocksToWithdrawal;\n        return _objectSpread({}, state, _defineProperty({}, _address, _objectSpread({}, safeAccess(state, [_address]) || {}, _defineProperty({}, _tokenAddress, _objectSpread({}, safeAccess(state, [_address, _tokenAddress]) || {}, {\n          blocksToWithdrawal: blocksToWithdrawal\n        })))));\n      }\n    default:\n      {\n        throw Error(\"Unexpected action type in WithdrawalContext reducer: '\".concat(type, \"'.\"));\n      }\n  }\n}\nexport default function Provider(_ref2) {\n  var children = _ref2.children;\n  var _useReducer = useReducer(reducer, {}),\n    _useReducer2 = _slicedToArray(_useReducer, 2),\n    state = _useReducer2[0],\n    dispatch = _useReducer2[1];\n  var updateLimit = useCallback(function (address, tokenAddress, withdrawalLimit) {\n    dispatch({\n      type: UPDATE_LIMIT,\n      payload: {\n        address: address,\n        tokenAddress: tokenAddress,\n        withdrawalLimit: withdrawalLimit\n      }\n    });\n  }, []);\n  var updateFee = useCallback(function (withdrawalFee) {\n    dispatch({\n      type: UPDATE_FEE,\n      payload: {\n        withdrawalFee: withdrawalFee\n      }\n    });\n  }, []);\n  var updateBlocks = useCallback(function (address, tokenAddress, blocksToWithdrawal) {\n    dispatch({\n      type: UPDATE_BLOCKS,\n      payload: {\n        address: address,\n        tokenAddress: tokenAddress,\n        blocksToWithdrawal: blocksToWithdrawal\n      }\n    });\n  }, []);\n  return /*#__PURE__*/React.createElement(WithdrawalContext.Provider, {\n    value: useMemo(function () {\n      return [state, {\n        updateLimit: updateLimit,\n        updateFee: updateFee,\n        updateBlocks: updateBlocks\n      }];\n    }, [state, updateLimit, updateFee, updateBlocks]),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 5\n    }\n  }, children);\n}\nexport function useWithdrawalFee(gasPrice, privateKey) {\n  //const nocust = useNocustClient()\n  var _useWithdrawalContext = useWithdrawalContext(),\n    _useWithdrawalContext2 = _slicedToArray(_useWithdrawalContext, 2),\n    state = _useWithdrawalContext2[0],\n    updateFee = _useWithdrawalContext2[1].updateFee;\n  var withdrawalFee = state.withdrawalFee;\n  useEffect(function () {\n    var useWithdrawFee = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var withdrawFee;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return nocust.init({\n                  contractAddress: process.env.REACT_APP_HUB_CONTRACT_ADDRESS,\n                  rpcUrl: process.env.REACT_APP_WEB3_PROVIDER,\n                  operatorUrl: process.env.REACT_APP_HUB_API_URL\n                });\n              case 2:\n                _context.next = 4;\n                return nocust.addPrivateKey(privateKey);\n              case 4:\n                //console.log(\"Private key added\");\n\n                try {\n                  withdrawFee = nocust.getWithdrawalFee(gasPrice);\n                  updateFee(withdrawFee);\n                } catch (err) {\n                  console.error(err);\n                  updateFee(null);\n                }\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return function useWithdrawFee() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n    useWithdrawFee();\n  }, [gasPrice]);\n  return withdrawalFee;\n}\nexport function useWithdrawalLimit(address, tokenAddress, privateKey) {\n  //const nocust = useNocustClient()\n  console.log('pk', privateKey);\n  var eraNumber = useEraNumber();\n  var _useWithdrawalContext3 = useWithdrawalContext(),\n    _useWithdrawalContext4 = _slicedToArray(_useWithdrawalContext3, 2),\n    state = _useWithdrawalContext4[0],\n    updateLimit = _useWithdrawalContext4[1].updateLimit;\n  var _ref4 = safeAccess(state, [address, tokenAddress]) || {},\n    withdrawalLimit = _ref4.withdrawalLimit;\n  useEffect(function () {\n    if (isAddress(address) && isAddress(tokenAddress)) {\n      console.log('checking withdrawal limit');\n      var checkWithdrawLimit = /*#__PURE__*/function () {\n        var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n          var withdrawLimit;\n          return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  _context2.next = 2;\n                  return nocust.init({\n                    contractAddress: process.env.REACT_APP_HUB_CONTRACT_ADDRESS,\n                    rpcUrl: process.env.REACT_APP_WEB3_PROVIDER,\n                    operatorUrl: process.env.REACT_APP_HUB_API_URL\n                  });\n                case 2:\n                  _context2.next = 4;\n                  return nocust.addPrivateKey(privateKey);\n                case 4:\n                  //console.log(\"Private key added\");\n\n                  try {\n                    withdrawLimit = nocust.getWithdrawalLimit(address, tokenAddress);\n                    updateLimit(address, tokenAddress, withdrawLimit);\n                  } catch (err) {\n                    console.error(err);\n                    updateLimit(address, tokenAddress, null);\n                  }\n                case 5:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        }));\n        return function checkWithdrawLimit() {\n          return _ref5.apply(this, arguments);\n        };\n      }();\n      checkWithdrawLimit();\n    }\n  }, [address, tokenAddress, eraNumber]);\n  return withdrawalLimit;\n}\nexport function useBlocksToWithdrawal(address, tokenAddress) {\n  //const nocust = useNocustClient()\n  useEffect(function () {\n    _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return createNocustManager(process.env.REACT_APP_WEB3_PROVIDER, process.env.REACT_APP_HUB_CONTRACT_ADDRESS, process.env.REACT_APP_HUB_API_URL);\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }))();\n    return function () {\n      // this now gets called when the component unmounts\n    };\n  }, []);\n  var eraNumber = useEraNumber();\n  var _useWithdrawalContext5 = useWithdrawalContext(),\n    _useWithdrawalContext6 = _slicedToArray(_useWithdrawalContext5, 2),\n    state = _useWithdrawalContext6[0],\n    updateBlocks = _useWithdrawalContext6[1].updateBlocks;\n  var _ref7 = safeAccess(state, [address, tokenAddress]) || {},\n    blocksToWithdrawal = _ref7.blocksToWithdrawal;\n  useEffect(function () {\n    if (isAddress(address) && isAddress(tokenAddress)) {\n      nocust.getBlocksToWithdrawalConfirmation(address, undefined, tokenAddress).then(function (blocksToWithdrawal) {\n        updateBlocks(address, tokenAddress, blocksToWithdrawal);\n      }).catch(function () {\n        updateBlocks(address, tokenAddress, undefined);\n      });\n    }\n  }, [address, tokenAddress, eraNumber]);\n  return blocksToWithdrawal;\n}\nexport function useAllBlocksToWithdrawal(address) {\n  //const nocust = useNocustClient()\n  useEffect(function () {\n    _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n      return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return createNocustManager(process.env.REACT_APP_WEB3_PROVIDER, process.env.REACT_APP_HUB_CONTRACT_ADDRESS, process.env.REACT_APP_HUB_API_URL);\n            case 2:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }))();\n    return function () {\n      // this now gets called when the component unmounts\n    };\n  }, []);\n  var eraNumber = useEraNumber();\n  var tokens = useTokens();\n  var _useWithdrawalContext7 = useWithdrawalContext(),\n    _useWithdrawalContext8 = _slicedToArray(_useWithdrawalContext7, 2),\n    state = _useWithdrawalContext8[0],\n    updateBlocks = _useWithdrawalContext8[1].updateBlocks;\n  var withdrawalObject = safeAccess(state, [address]) || {};\n  useEffect(function () {\n    if (nocust && tokens && Object.keys(tokens).length > 0 && isAddress(address)) {\n      Promise.all(Object.values(tokens).map( /*#__PURE__*/function () {\n        var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(_ref9) {\n          var tokenAddress;\n          return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n            while (1) {\n              switch (_context5.prev = _context5.next) {\n                case 0:\n                  tokenAddress = _ref9.tokenAddress;\n                  _context5.t0 = tokenAddress;\n                  _context5.next = 4;\n                  return nocust.getBlocksToWithdrawalConfirmation(address, undefined, tokenAddress);\n                case 4:\n                  _context5.t1 = _context5.sent;\n                  return _context5.abrupt(\"return\", {\n                    tokenAddress: _context5.t0,\n                    blocksToWithdrawal: _context5.t1\n                  });\n                case 6:\n                case \"end\":\n                  return _context5.stop();\n              }\n            }\n          }, _callee5);\n        }));\n        return function (_x) {\n          return _ref10.apply(this, arguments);\n        };\n      }())).then(function (tokenList) {\n        tokenList.forEach(function (_ref11) {\n          var tokenAddress = _ref11.tokenAddress,\n            blocksToWithdrawal = _ref11.blocksToWithdrawal;\n          if (tokenAddress !== undefined) {\n            updateBlocks(address, tokenAddress, blocksToWithdrawal);\n          }\n        });\n      }).catch(function () {\n        console.log(\"I'm in a bother\");\n      });\n    }\n  }, [address, eraNumber]);\n  return Object.entries(withdrawalObject).reduce(function (accumulator, _ref12) {\n    var _ref13 = _slicedToArray(_ref12, 2),\n      tokenAddress = _ref13[0],\n      blocksToWithdrawal = _ref13[1].blocksToWithdrawal;\n    accumulator[tokenAddress] = blocksToWithdrawal;\n    return accumulator;\n  }, {});\n}\nexport function getNextAvailableConfirmation(address) {\n  var withdrawalObject = useAllBlocksToWithdrawal(address);\n  var _Object$entries$filte = Object.entries(withdrawalObject).filter(function (_ref14) {\n      var _ref15 = _slicedToArray(_ref14, 2),\n        blocksToWithdrawal = _ref15[1];\n      return blocksToWithdrawal >= 0;\n    }) // blocksToWithdrawal = -1 means no withdrawal in progress\n    .reduce(function (min, trial) {\n      if (min.length === 0) return trial;\n      return trial[1] < min[1] ? trial : min;\n    }, []),\n    _Object$entries$filte2 = _slicedToArray(_Object$entries$filte, 2),\n    tokenAddress = _Object$entries$filte2[0],\n    blocksToWithdrawal = _Object$entries$filte2[1];\n  return {\n    tokenAddress: tokenAddress,\n    blocksToWithdrawal: blocksToWithdrawal\n  };\n}","map":{"version":3,"names":["React","createContext","useContext","useReducer","useMemo","useCallback","useEffect","safeAccess","isAddress","useNocustClient","useEraNumber","useTokens","createNocustManager","nocust","Web3","UPDATE_LIMIT","UPDATE_FEE","UPDATE_BLOCKS","WithdrawalContext","useWithdrawalContext","reducer","state","type","payload","withdrawalFee","address","tokenAddress","withdrawalLimit","blocksToWithdrawal","Error","Provider","children","dispatch","updateLimit","updateFee","updateBlocks","useWithdrawalFee","gasPrice","privateKey","useWithdrawFee","init","contractAddress","process","env","REACT_APP_HUB_CONTRACT_ADDRESS","rpcUrl","REACT_APP_WEB3_PROVIDER","operatorUrl","REACT_APP_HUB_API_URL","addPrivateKey","withdrawFee","getWithdrawalFee","err","console","error","useWithdrawalLimit","log","eraNumber","checkWithdrawLimit","withdrawLimit","getWithdrawalLimit","useBlocksToWithdrawal","getBlocksToWithdrawalConfirmation","undefined","then","catch","useAllBlocksToWithdrawal","tokens","withdrawalObject","Object","keys","length","Promise","all","values","map","tokenList","forEach","entries","reduce","accumulator","getNextAvailableConfirmation","filter","min","trial"],"sources":["/home/cryptodev/Dev/aegis-burner/src/contexts/Withdrawal.js"],"sourcesContent":["import React, { createContext, useContext, useReducer, useMemo, useCallback, useEffect } from 'react'\n\nimport { safeAccess } from '../utils'\nimport { isAddress } from 'web3-utils'\nimport { useNocustClient, useEraNumber } from './Nocust'\nimport { useTokens } from './Tokens'\n\nimport { createNocustManager } from '../services/nocustManager'\nimport { nocust } from 'nocust-client'\nimport Web3 from 'web3'\n\nconst UPDATE_LIMIT = 'UPDATE_LIMIT'\nconst UPDATE_FEE = 'UPDATE_FEE'\nconst UPDATE_BLOCKS = 'UPDATE_BlOCKS'\n\nconst WithdrawalContext = createContext()\n\nfunction useWithdrawalContext () {\n  return useContext(WithdrawalContext)\n}\n\nfunction reducer (state, { type, payload }) {\n  switch (type) {\n    case UPDATE_FEE: {\n      const { withdrawalFee } = payload\n      return {\n        ...state,\n        withdrawalFee\n      }\n    }\n    case UPDATE_LIMIT: {\n      const { address, tokenAddress, withdrawalLimit } = payload\n      return {\n        ...state,\n        [address]: {\n          ...(safeAccess(state, [address]) || {}),\n          [tokenAddress]: {\n            ...(safeAccess(state, [address, tokenAddress]) || {}),\n            withdrawalLimit\n          }\n        }\n      }\n    }\n    case UPDATE_BLOCKS: {\n      const { address, tokenAddress, blocksToWithdrawal } = payload\n      return {\n        ...state,\n        [address]: {\n          ...(safeAccess(state, [address]) || {}),\n          [tokenAddress]: {\n            ...(safeAccess(state, [address, tokenAddress]) || {}),\n            blocksToWithdrawal\n          }\n        }\n      }\n    }\n    default: {\n      throw Error(`Unexpected action type in WithdrawalContext reducer: '${type}'.`)\n    }\n  }\n}\n\nexport default function Provider ({ children }) {\n  const [state, dispatch] = useReducer(reducer, {})\n\n  const updateLimit = useCallback((address, tokenAddress, withdrawalLimit) => {\n    dispatch({ type: UPDATE_LIMIT, payload: { address, tokenAddress, withdrawalLimit } })\n  }, [])\n\n  const updateFee = useCallback((withdrawalFee) => {\n    dispatch({ type: UPDATE_FEE, payload: { withdrawalFee } })\n  }, [])\n\n  const updateBlocks = useCallback((address, tokenAddress, blocksToWithdrawal) => {\n    dispatch({ type: UPDATE_BLOCKS, payload: { address, tokenAddress, blocksToWithdrawal } })\n  }, [])\n\n  return (\n    <WithdrawalContext.Provider value={useMemo(() => [state, { updateLimit, updateFee, updateBlocks }], [state, updateLimit, updateFee, updateBlocks])}>\n      {children}\n    </WithdrawalContext.Provider>\n  )\n}\n\nexport function useWithdrawalFee (gasPrice, privateKey) {\n  //const nocust = useNocustClient()\n  const [state, { updateFee }] = useWithdrawalContext()\n  const { withdrawalFee } = state\n\n  useEffect(() => {\n    const useWithdrawFee = async () => {\n\n      await nocust.init({\n        contractAddress: process.env.REACT_APP_HUB_CONTRACT_ADDRESS,\n        rpcUrl: process.env.REACT_APP_WEB3_PROVIDER,\n        operatorUrl: process.env.REACT_APP_HUB_API_URL\n      });\n    \n      await nocust.addPrivateKey(privateKey);\n      //console.log(\"Private key added\");\n    \n      try {\n        const withdrawFee = nocust.getWithdrawalFee(gasPrice)\n        updateFee(withdrawFee)\n       } catch (err) {\n        console.error(err)\n        updateFee(null)\n       }\n    };\n    \n    useWithdrawFee();\n  \n  }, [gasPrice]);\n\n  return withdrawalFee\n}\n\nexport function useWithdrawalLimit (address, tokenAddress, privateKey) {\n  //const nocust = useNocustClient()\n  console.log('pk', privateKey)\n  const eraNumber = useEraNumber()\n  const [state, { updateLimit }] = useWithdrawalContext()\n  const { withdrawalLimit } = safeAccess(state, [address, tokenAddress]) || {}\n\n  useEffect(() => {\n    if (isAddress(address) && isAddress(tokenAddress)) {\n      console.log('checking withdrawal limit')\n      const checkWithdrawLimit = async () => {\n\n        await nocust.init({\n          contractAddress: process.env.REACT_APP_HUB_CONTRACT_ADDRESS,\n          rpcUrl: process.env.REACT_APP_WEB3_PROVIDER,\n          operatorUrl: process.env.REACT_APP_HUB_API_URL\n        });\n      \n        await nocust.addPrivateKey(privateKey);\n        //console.log(\"Private key added\");\n      \n        try {\n          const withdrawLimit = nocust.getWithdrawalLimit(address, tokenAddress)\n          updateLimit(address, tokenAddress, withdrawLimit)\n         } catch (err) {\n          console.error(err)\n          updateLimit(address, tokenAddress, null)\n         }\n      };\n      \n      checkWithdrawLimit();\n    }\n  }, [address, tokenAddress, eraNumber])\n\n  return withdrawalLimit\n}\n\nexport function useBlocksToWithdrawal (address, tokenAddress) {\n  //const nocust = useNocustClient()\n  useEffect(() => {\n    (async () => {\n      await createNocustManager(process.env.REACT_APP_WEB3_PROVIDER, process.env.REACT_APP_HUB_CONTRACT_ADDRESS, process.env.REACT_APP_HUB_API_URL)\n    })();\n    \n    return () => {\n      // this now gets called when the component unmounts\n    };\n  }, []);\n  const eraNumber = useEraNumber()\n  const [state, { updateBlocks }] = useWithdrawalContext()\n  const { blocksToWithdrawal } = safeAccess(state, [address, tokenAddress]) || {}\n\n  useEffect(() => {\n    if (isAddress(address) && isAddress(tokenAddress)) {\n      nocust.getBlocksToWithdrawalConfirmation(address, undefined, tokenAddress)\n        .then(blocksToWithdrawal => {\n          updateBlocks(address, tokenAddress, blocksToWithdrawal)\n        })\n        .catch(() => {\n          updateBlocks(address, tokenAddress, undefined)\n        })\n    }\n  }, [address, tokenAddress, eraNumber])\n\n  return blocksToWithdrawal\n}\n\nexport function useAllBlocksToWithdrawal (address) {\n  //const nocust = useNocustClient()\n  useEffect(() => {\n    (async () => {\n      await createNocustManager(process.env.REACT_APP_WEB3_PROVIDER, process.env.REACT_APP_HUB_CONTRACT_ADDRESS, process.env.REACT_APP_HUB_API_URL)\n    })();\n    \n    return () => {\n      // this now gets called when the component unmounts\n    };\n  }, []);\n\n  const eraNumber = useEraNumber()\n  const tokens = useTokens()\n  const [state, { updateBlocks }] = useWithdrawalContext()\n  const withdrawalObject = safeAccess(state, [address]) || {}\n\n  useEffect(() => {\n    if (nocust && tokens && Object.keys(tokens).length > 0 && isAddress(address)) {\n      Promise.all(Object.values(tokens).map(async ({ tokenAddress }) => {\n        return { tokenAddress: tokenAddress, blocksToWithdrawal: await nocust.getBlocksToWithdrawalConfirmation(address, undefined, tokenAddress) }\n      }))\n        .then(tokenList => {\n          tokenList.forEach(({ tokenAddress, blocksToWithdrawal }) => {\n            if (tokenAddress !== undefined) {\n              updateBlocks(address, tokenAddress, blocksToWithdrawal)\n            }\n          })\n        })\n        .catch(() => {\n          console.log(\"I'm in a bother\")\n        })\n    }\n  }, [address, eraNumber])\n\n  return Object.entries(withdrawalObject).reduce((accumulator, [tokenAddress, { blocksToWithdrawal }]) => {\n    accumulator[tokenAddress] = blocksToWithdrawal\n    return accumulator\n  }, {})\n}\n\nexport function getNextAvailableConfirmation (address) {\n  const withdrawalObject = useAllBlocksToWithdrawal(address)\n\n  const [tokenAddress, blocksToWithdrawal] = Object.entries(withdrawalObject)\n    .filter(([, blocksToWithdrawal]) => blocksToWithdrawal >= 0) // blocksToWithdrawal = -1 means no withdrawal in progress\n    .reduce((min, trial) => {\n      if (min.length === 0) return trial\n      return trial[1] < min[1] ? trial : min\n    }, [])\n\n  return { tokenAddress, blocksToWithdrawal }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}