{"ast":null,"code":"// snagged from https://stackoverflow.com/questions/52759238/private-incognito-mode-detection-for-ios-12-safari\n\nfunction retry(isDone, next) {\n  var currentTrial = 0;\n  var maxRetry = 50;\n  var isTimeout = false;\n  var id = window.setInterval(function () {\n    if (isDone()) {\n      window.clearInterval(id);\n      next(isTimeout);\n    }\n    if (currentTrial++ > maxRetry) {\n      window.clearInterval(id);\n      isTimeout = true;\n      next(isTimeout);\n    }\n  }, 10);\n}\nfunction isIE10OrLater(userAgent) {\n  var ua = userAgent.toLowerCase();\n  if (ua.indexOf('msie') === 0 && ua.indexOf('trident') === 0) {\n    return false;\n  }\n  var match = /(?:msie|rv:)\\s?([\\d.]+)/.exec(ua);\n  if (match && parseInt(match[1], 10) >= 10) {\n    return true;\n  }\n  // MS Edge Detection from this gist: https://gist.github.com/cou929/7973956\n  var edge = /edge/.exec(ua);\n  if (edge && edge[0] === 'edge') {\n    return true;\n  }\n  return false;\n}\nmodule.exports = function (callback) {\n  var isPrivate;\n  if (window.webkitRequestFileSystem) {\n    window.webkitRequestFileSystem(window.TEMPORARY, 1, function () {\n      isPrivate = false;\n    }, function (e) {\n      console.log(e);\n      isPrivate = true;\n    });\n  } else if (window.indexedDB && /Firefox/.test(window.navigator.userAgent)) {\n    var db;\n    try {\n      db = window.indexedDB.open('test');\n    } catch (e) {\n      isPrivate = true;\n    }\n    if (typeof isPrivate === 'undefined') {\n      retry(function isDone() {\n        return db.readyState === 'done';\n      }, function next(isTimeout) {\n        if (!isTimeout) {\n          isPrivate = !db.result;\n        }\n      });\n    }\n  } else if (isIE10OrLater(window.navigator.userAgent)) {\n    isPrivate = false;\n    try {\n      if (!window.indexedDB) {\n        isPrivate = true;\n      }\n    } catch (e) {\n      isPrivate = true;\n    }\n  } else if (window.localStorage && /Safari/.test(window.navigator.userAgent)) {\n    // One-off check for weird sports 2.0 polyfill\n    // This also impacts iOS Firefox and Chrome (newer versions), apparently\n    // @see bglobe-js/containers/App.js:116\n    if (window.safariIncognito) {\n      isPrivate = true;\n    } else {\n      try {\n        window.openDatabase(null, null, null, null);\n      } catch (e) {\n        isPrivate = true;\n      }\n      try {\n        window.localStorage.setItem('test', 1);\n      } catch (e) {\n        isPrivate = true;\n      }\n    }\n    if (typeof isPrivate === 'undefined') {\n      isPrivate = false;\n      window.localStorage.removeItem('test');\n    }\n  }\n  retry(function isDone() {\n    return typeof isPrivate !== 'undefined';\n  }, function next(isTimeout) {\n    callback(isTimeout);\n  });\n};","map":{"version":3,"names":["retry","isDone","next","currentTrial","maxRetry","isTimeout","id","window","setInterval","clearInterval","isIE10OrLater","userAgent","ua","toLowerCase","indexOf","match","exec","parseInt","edge","module","exports","callback","isPrivate","webkitRequestFileSystem","TEMPORARY","e","console","log","indexedDB","test","navigator","db","open","readyState","result","localStorage","safariIncognito","openDatabase","setItem","removeItem"],"sources":["/home/cryptodev/Dev/aegis-burner/src/services/incogDetect.js"],"sourcesContent":["\n// snagged from https://stackoverflow.com/questions/52759238/private-incognito-mode-detection-for-ios-12-safari\n\nfunction retry (isDone, next) {\n  var currentTrial = 0; var maxRetry = 50; var isTimeout = false\n  var id = window.setInterval(\n    function () {\n      if (isDone()) {\n        window.clearInterval(id)\n        next(isTimeout)\n      }\n      if (currentTrial++ > maxRetry) {\n        window.clearInterval(id)\n        isTimeout = true\n        next(isTimeout)\n      }\n    },\n    10\n  )\n}\n\nfunction isIE10OrLater (userAgent) {\n  var ua = userAgent.toLowerCase()\n  if (ua.indexOf('msie') === 0 && ua.indexOf('trident') === 0) {\n    return false\n  }\n  var match = /(?:msie|rv:)\\s?([\\d.]+)/.exec(ua)\n  if (match && parseInt(match[1], 10) >= 10) {\n    return true\n  }\n  // MS Edge Detection from this gist: https://gist.github.com/cou929/7973956\n  var edge = /edge/.exec(ua)\n  if (edge && edge[0] === 'edge') {\n    return true\n  }\n  return false\n}\n\nmodule.exports = function (callback) {\n  var isPrivate\n\n  if (window.webkitRequestFileSystem) {\n    window.webkitRequestFileSystem(\n      window.TEMPORARY, 1,\n      function () {\n        isPrivate = false\n      },\n      function (e) {\n        console.log(e)\n        isPrivate = true\n      }\n    )\n  } else if (window.indexedDB && /Firefox/.test(window.navigator.userAgent)) {\n    var db\n    try {\n      db = window.indexedDB.open('test')\n    } catch (e) {\n      isPrivate = true\n    }\n\n    if (typeof isPrivate === 'undefined') {\n      retry(\n        function isDone () {\n          return db.readyState === 'done'\n        },\n        function next (isTimeout) {\n          if (!isTimeout) {\n            isPrivate = !db.result\n          }\n        }\n      )\n    }\n  } else if (isIE10OrLater(window.navigator.userAgent)) {\n    isPrivate = false\n    try {\n      if (!window.indexedDB) {\n        isPrivate = true\n      }\n    } catch (e) {\n      isPrivate = true\n    }\n  } else if (window.localStorage && /Safari/.test(window.navigator.userAgent)) {\n    // One-off check for weird sports 2.0 polyfill\n    // This also impacts iOS Firefox and Chrome (newer versions), apparently\n    // @see bglobe-js/containers/App.js:116\n    if (window.safariIncognito) {\n      isPrivate = true\n    } else {\n      try {\n        window.openDatabase(null, null, null, null)\n      } catch (e) {\n        isPrivate = true\n      }\n      try {\n        window.localStorage.setItem('test', 1)\n      } catch (e) {\n        isPrivate = true\n      }\n    }\n\n    if (typeof isPrivate === 'undefined') {\n      isPrivate = false\n      window.localStorage.removeItem('test')\n    }\n  }\n\n  retry(\n    function isDone () {\n      return typeof isPrivate !== 'undefined'\n    },\n    function next (isTimeout) {\n      callback(isTimeout)\n    }\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}